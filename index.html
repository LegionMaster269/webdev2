<!DOCTYPE html>
<html>
<head>
    <title>Web USB API Example</title>
</head>
<body>
    <h1>Web USB API Example</h1>
    <button id="connectButton">Connect to USB Device</button>
    <button id="disconnectButton" disabled>Disconnect</button>
    <div id="output"></div>

    <script>
        // Function to connect to a USB device
        async function connectToDevice() {
            try {
                const device = await navigator.usb.requestDevice({ filters: [] });

                await device.open();
                await device.selectConfiguration(1); // Select the first configuration (usually 1)
                await device.claimInterface(0); // Claim the first interface (usually 0)

                document.getElementById('connectButton').disabled = true;
                document.getElementById('disconnectButton').disabled = false;

                // Access the device and perform operations here
                // For example, you can read data from or send data to the device.
                // You would typically use device.transferIn() and device.transferOut() for data transfer.

                // Display device information
                const output = document.getElementById('output');
                output.innerHTML = `Connected to USB device:<br>`;
                output.innerHTML += `Product ID: ${device.productId}<br>`;
                output.innerHTML += `Vendor ID: ${device.vendorId}<br>`;
                output.innerHTML += `Serial Number: ${device.serialNumber || 'N/A'}<br>`;
            } catch (error) {
                console.error('Error connecting to USB device:', error);
            }
        }

        // Function to disconnect from the USB device
        async function disconnectDevice() {
            try {
                const device = await navigator.usb.getDevices();
                if (device.length > 0) {
                    await device[0].close();
                }

                document.getElementById('connectButton').disabled = false;
                document.getElementById('disconnectButton').disabled = true;
                document.getElementById('output').innerHTML = 'Disconnected from USB device.';
            } catch (error) {
                console.error('Error disconnecting from USB device:', error);
            }
        }

        // Event listeners for the buttons
        document.getElementById('connectButton').addEventListener('click', connectToDevice);
        document.getElementById('disconnectButton').addEventListener('click', disconnectDevice);
    </script>
</body>
</html>
